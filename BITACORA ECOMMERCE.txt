BITACORA ECOMMERCE

1. Instalar Docker y levantar los contenedores

	a. docker run -d --name ec-rabbitmq -p 15672:15672 -p 5672:5672 rabbitmq:3.13.6-management
	b. docker run -d --name ec-mongo -p 27017:27017 mongo:6.0
	c. docker run -d --name ec-redis -p 6379:6379 redis:7
	d. docker ps
2. Crear arquitectura del Microservicio UserFeed:

Domain: Entidades (UserComment, User) y Ports (interfaces)
Application: Casos de uso y DTOs
Infrastructure: Adapters para MongoDB, RabbitMQ y Auth Service
API: Controllers REST y configuraciÃ³n
CaracterÃ­sticas implementadas:

âœ… MongoDB para persistencia
âœ… RabbitMQ para mensajerÃ­a asÃ­ncrona (logout events)
âœ… AutenticaciÃ³n JWT integrada con Auth Service
âœ… Swagger/OpenAPI para documentaciÃ³n interactiva
âœ… CORS configurado
âœ… Dockerfile para deployments

ðŸ“¡ Endpoints disponibles:
âœ… POST /api/v1/Comments
Crear un nuevo comentario sobre un artÃ­culo

Extrae userId del token JWT
ValidaciÃ³n de Ã³rdenes: Verifica que el usuario tenga Ã³rdenes de compra validadas
Si no tiene â†’ 401: "El usuario no tiene ordenes de compra validas para poder realizar un comentario"
ValidaciÃ³n de artÃ­culo: Verifica que el artÃ­culo existe en el catÃ¡logo
Si no existe â†’ 400: "El articulo seleccionado {articleId} no existe"
ValidaciÃ³n de compra: Verifica que el usuario comprÃ³ ese artÃ­culo especÃ­fico
Consulta GET /orders para obtener Ã³rdenes validadas
Para cada orden, consulta GET /orders/{id} para obtener detalles
Verifica que el artÃ­culo estÃ© en la orden con isValidated = true
Si no lo comprÃ³ â†’ 401: "El usuario no ha comprado el articulo seleccionado {articleId} por lo que no podra realizar un comentario"
ValidaciÃ³n de duplicado: Verifica que no exista un comentario previo del usuario para ese artÃ­culo
Si ya existe â†’ 409: "Ya existe un comentario para el articulo {articleId} realizado por el usuario"
Si todas las validaciones pasan:
Crea el comentario con CreatedAt = DateTime.UtcNow
Retorna 201 Created con el CommentResponse completo

âœ… GET /api/v1/Comments/my-comments
Obtener todos los comentarios del usuario autenticado

Extrae userId del token JWT
Si no hay token â†’ 401: "Token no proporcionado"
Si token invÃ¡lido â†’ 401: "Usuario no autenticado"
Consulta MongoDB filtrando por:
userId = userId del token
IsDeleted = false
Ordena por CreatedAt descendente
PaginaciÃ³n: page = 1, pageSize = 1000
Retorna 200 OK con array de CommentResponse

âœ… GET /api/v1/Comments/article/{articleId}
Obtener todos los comentarios de un artÃ­culo

Recibe articleId como parÃ¡metro de ruta
ParÃ¡metros opcionales de query:
page (default = 1)
pageSize (default = 10)
Consulta MongoDB filtrando por:
articleId = parÃ¡metro recibido
IsDeleted = false
Ordena por CreatedAt descendente
Aplica paginaciÃ³n (Skip/Limit)
Retorna 200 OK con array de CommentResponse
Incluye comentarios de todos los usuarios para ese artÃ­culo
Solo muestra comentarios NO eliminados

âœ… PUT /api/v1/Comments/{id}
Actualizar un comentario existente

Extrae userId del token JWT
Busca el comentario por id
Validaciones:
Si no existe â†’ 404: "El comentario seleccionado no existe"
Si IsDeleted = true â†’ 400: "El comentario esta eliminado y no puede ser actualizado"
Si el userId del comentario no coincide con el del token â†’ 401: "El comentario seleccionado no lo realizo el usuario logueado, por lo que no lo podrÃ¡ actualizar"
Si todo es vÃ¡lido:
Actualiza Comment y Rating con los datos del request
Establece UpdatedAt = DateTime.UtcNow
Retorna 200 OK con CommentResponse actualizado

âœ… DELETE /api/v1/Comments/{id}
Eliminar un comentario (lÃ³gico)

Extrae userId del token
Busca el comentario por id
Validaciones:
Si no existe â†’ 404: "Comentario no encontrado"
Si IsDeleted = true â†’ 400: "Este comentario ya esta eliminado y no se puede volver a eliminar"
Si el userId del comentario no coincide con el del token â†’ 401: "No podes eliminar comentarios de otros usuarios"
Si todo es vÃ¡lido:
Marca IsDeleted = true
Establece UpdatedAt = DateTime.UtcNow
Retorna 204 No Content

ðŸŒ Acceso:
API: http://localhost:5000 (comando para levantarlo -> dotnet UserFeed.Api\bin\Debug\net6.0\UserFeed.Api.dll)
Swagger UI: http://localhost:5000 (ya abierto en el navegador)
RabbitMQ Admin: http://localhost:15672 (guest/guest)

ðŸ“š PrÃ³ximos pasos:
Para probar el microservicio completamente necesitarÃ¡s:

Levantar el servicio Auth (puerto 3000) para obtener tokens JWT, acceder desde postman
Usar Swagger para probar los endpoints, acceder a http://localhost:5005/index.html
Acceder a la DB: 
